{% for node in nodes %}
<tr
  class="cc-row level-{{ level }} {% if level > 0 and parent_label and "inventory" in parent_label|lower %}is-hidden{% endif %}"
  data-id="{{ node.id }}"
  data-level="{{ level }}"
  {% if parent_id %}data-parent="{{ parent_id }}"{% endif %}
>
  <td class="cc-label" style="--lvl:{{ level }};">
    {% if level > 0 %}
      {{ node.row.detail|default:node.row.label }}
    {% else %}
      {{ node.row.label }}
    {% endif %}
  </td>

  <td>{{ node.row.beginning_collateral }}</td>
  <td>{{ node.row.ineligibles }}</td>
  <td>{{ node.row.eligible_collateral }}</td>
  <td>{{ node.row.nolv_pct }}</td>
  <td>{{ node.row.dilution_rate }}</td>
  <td>{{ node.row.advanced_rate }}</td>
  <td>{{ node.row.rate_limit }}</td>
  <td>{{ node.row.utilized_rate }}</td>
  <td>{{ node.row.pre_reserve_collateral }}</td>
  <td>{{ node.row.reserves }}</td>
  <td>{{ node.row.net_collateral }}</td>

  <td class="cc-ctl">
    {% if node.children and level == 0 and "inventory" in node.row.label|lower %}
      <button
        class="cc-toggle"
        type="button"
        data-row="{{ node.id }}"
        aria-expanded="false"
      >
        <span class="cc-chevron" aria-hidden="true"></span>
      </button>
    {% endif %}
  </td>
</tr>

{% if node.children %}
  {% include "partials/collateral_rows.html" with nodes=node.children level=level|add:1 parent_id=node.id parent_label=node.row.label %}
{% endif %}
{% endfor %}
