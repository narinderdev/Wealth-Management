{% for node in nodes %}
{% with row_text=node.row.detail|default:node.row.label %}
{% with row_text_lower=row_text|lower %}
<tr
  class="cc-row level-{{ level }} {% if level > 0 %}is-hidden{% endif %}{% if 'finished goods' in row_text_lower or 'raw material' in row_text_lower or 'work in process' in row_text_lower or 'work-in-process' in row_text_lower %} cc-row--sub{% endif %}"
  data-id="{{ node.id }}"
  data-level="{{ level }}"
  {% if parent_id %}data-parent="{{ parent_id }}"{% endif %}
>
  <td class="cc-label{% if 'finished goods' in row_text_lower or 'raw material' in row_text_lower or 'work in process' in row_text_lower or 'work-in-process' in row_text_lower %} cc-label--sub{% endif %}" style="--lvl:{{ level }};">
    {{ row_text }}
  </td>

  <td>{{ node.row.beginning_collateral }}</td>
  <td>{{ node.row.ineligibles }}</td>
  <td>{{ node.row.eligible_collateral }}</td>
  <td>{{ node.row.nolv_pct }}</td>
  <td>{{ node.row.dilution_rate }}</td>
  <td>{{ node.row.advanced_rate }}</td>
  <td>{{ node.row.rate_limit }}</td>
  <td>{{ node.row.utilized_rate }}</td>
  <td>{{ node.row.pre_reserve_collateral }}</td>
  <td>{{ node.row.reserves }}</td>
  <td>{{ node.row.net_collateral }}</td>

  <td class="cc-ctl">
    {% if node.children and node.row.label|lower != "accounts receivable" and node.row.label|lower != "other collateral" %}
      <button
        class="cc-toggle"
        type="button"
        data-row="{{ node.id }}"
        aria-expanded="false"
      >
        <span class="cc-chevron" aria-hidden="true"></span>
      </button>
    {% endif %}
  </td>
</tr>
{% endwith %}
{% endwith %}

{% if node.children %}
  {% include "partials/collateral_rows.html" with nodes=node.children level=level|add:1 parent_id=node.id parent_label=node.row.label %}
{% endif %}
{% endfor %}
