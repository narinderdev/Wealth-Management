{% extends "layout/app_base.html" %}
{% load static %}
{% block title %}Limits{% endblock %}

{% block extra_head %}
  {{ block.super }}
  <style>
    .limits-page .card{
      background:#ffffff;
      border:1px solid #e3eaf7;
      border-radius:12px;
      padding:14px 16px;
      max-width:1819px;
      margin-bottom:16px;
      margin-top:16px;
      box-shadow:none;
    }
    .limits-page .card-title{
      display:flex;
      align-items:center;
      gap:6px;
      font-size:20px;
      font-weight:600;
      color:#585858;
      margin-bottom:12px;
    }
    .limits-page .table-scroll {
      margin-bottom:0;
      overflow:auto;
      max-height:none;
      border:1px solid #e3eaf7;
      border-radius:12px;
      background:#fff;
      padding:0;
    }
    .main-head{
     font-size: 24px;
     font-weight: 800;
     color:black;
     margin-top: 0px;
     margin-bottom: 0px;
     font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
     
    }
    .limits-page table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      font-size:12px;
      color:#475569;
    }
    .limits-page thead th{
      text-align:center;
      font-weight:700;
      font-size:12px;
      color:#6b7280;
      padding:10px 12px;
      background:#f7faff;
      border-bottom:1px solid #e3eaf7;
      white-space:nowrap;
      border-left:0;
      border-right:0;
    }
    .limits-page thead th:first-child{
      border-top-left-radius:10px;
      border-left:1px solid #e3eaf7;
      text-align:left;
    }
    .limits-page thead th:last-child{
      border-top-right-radius:10px;
      border-right:1px solid #e3eaf7;
    }
    .limits-page thead th + th{
      border-left:0;
    }
    .limits-page tbody td{
      padding:10px 12px;
      border-bottom:1px solid #eef2fb;
      color:#65758B;
      font-size:12px;
      font-weight:600;
      text-align:center;
      background:#fff;
      white-space:nowrap;
      border-left:0;
      border-right:0;
    }
    .limits-page tbody td:first-child{
      border-left:1px solid #e3eaf7;
      text-align:left;
    }
    .limits-page tbody td:last-child{
      border-right:1px solid #e3eaf7;
    }
    .limits-page tbody tr:last-child td{border-bottom:1px solid #e3eaf7;}
    .limits-page .right{text-align:center;}
    .limits-page th.limit-money,
    .limits-page td.limit-money{
      text-align:center;
      font-variant-numeric:tabular-nums;
      white-space:nowrap;
    }
    .limits-page .table-footer{
      display:flex;
      align-items:center;
      justify-content:space-between;
      font-size:12px;
      color:#6b7280;
      margin-top:8px;
    }
    .limits-page .pager{
      display:flex;
      gap:8px;
    }
    .limits-page .pager a{
      text-decoration:none;
      color:#1d4ed8;
      font-weight:600;
    }
    .limits-page .pager .disabled{
      color:#9ca3af;
      pointer-events:none;
    }
  </style>
{% endblock %}

{% block page_content %}
  <div class="limits-page">
    <div class="card">
      <div class="card-title"> <img src="{% static 'images/borrowing_icon.svg' %}" 
          alt="Current Update Icon"
          class="current-update-icon" /><h2 class="main-head"> Collateral Limits</h2></div>
      <div class="table-scroll">
      <table>
        <thead>
          <tr>
            <th>Division</th>
            <th>Collateral Type</th>
            <th>Collateral Sub-Type</th>
            <th class="limit-money">$ Limit</th>
            <th class="right">% Limit</th>
          </tr>
        </thead>
        <tbody>
          {% for row in limit_page %}
          <tr>
            <td>{{ row.division }}</td>
            <td>{{ row.collateral_type }}</td>
            <td>{{ row.collateral_sub_type }}</td>
            <td class="limit-money">{{ row.usd_limit }}</td>
            <td class="right">{{ row.pct_limit }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="right">No collateral limits have been configured.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      </div>
      {% if limit_page.paginator.num_pages > 1 %}
        <div class="table-footer">
          <div>Page {{ limit_page.number }} of {{ limit_page.paginator.num_pages }}</div>
          <div class="pager">
            {% if limit_page.has_previous %}
              <a href="?limits_page={{ limit_page.previous_page_number }}&ineligibles_page={{ ineligible_page.number }}">Prev</a>
            {% else %}
              <span class="disabled">Prev</span>
            {% endif %}
            {% if limit_page.has_next %}
              <a href="?limits_page={{ limit_page.next_page_number }}&ineligibles_page={{ ineligible_page.number }}">Next</a>
            {% else %}
              <span class="disabled">Next</span>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </div>

    <div class="card">
      <div class="card-title"> <img src="{% static 'images/borrowing_icon.svg' %}" 
          alt="Current Update Icon"
          class="current-update-icon" /><h2 class="main-head">Ineligibles</h2></div>
      <div class="table-scroll">
      <table>
        <thead>
          <tr>
            <th>Division</th>
            <th>Collateral Type</th>
            <th>Collateral Sub-Type</th>
          </tr>
        </thead>
        <tbody>
          {% for row in ineligible_page %}
          <tr>
            <td>{{ row.division }}</td>
            <td>{{ row.collateral_type }}</td>
            <td>{{ row.collateral_sub_type }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="3">No ineligible collateral at this time.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      </div>
      {% if ineligible_page.paginator.num_pages > 1 %}
        <div class="table-footer">
          <div>Page {{ ineligible_page.number }} of {{ ineligible_page.paginator.num_pages }}</div>
          <div class="pager">
            {% if ineligible_page.has_previous %}
              <a href="?limits_page={{ limit_page.number }}&ineligibles_page={{ ineligible_page.previous_page_number }}">Prev</a>
            {% else %}
              <span class="disabled">Prev</span>
            {% endif %}
            {% if ineligible_page.has_next %}
              <a href="?limits_page={{ limit_page.number }}&ineligibles_page={{ ineligible_page.next_page_number }}">Next</a>
            {% else %}
              <span class="disabled">Next</span>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}
